---
title: "**기업별 반도체 특허 시각화 및 분석**"
subtitle: "**S**tatistics **N**etwork **A**nalysis"
author: "조사방법론2 <br> 2조 <br> 가천대학교 응용통계학과 <br> 김민형, 박민지, 이건영, 이승민"
date: "`r Sys.Date()`"
output:
  html_document:
    code_folding: show
    fig_caption: yes
    fig_height: 7
    fig_width: 10
    highlight: haddock
    number_sections: yes
    pandoc_args:
    - --number-sections
    - --number-offset=0
    self_contained: no
    theme: cosmo
    toc: yes
    toc_depth: 3
    toc_float: yes
  pdf_document:
    toc: yes
    toc_depth: 3
  word_document:
    toc: yes
    toc_depth: '3'
---

<style type="text/css">
  body, td {
     font-size: 16px;
     font-family: 맑은 고딕
  }
  code.r{
    font-size: 16px;
    font-weight: bold;
    font-family: 맑은 고딕
  }
  pre {
    font-size: 14px
    font-family: 맑은 고딕
  }
  h1,h2,h3,h4,h5,h6{
    font-family: 맑은 고딕;
  }
  h1{
    font-size: 22pt;
  }
  h2{
    font-size: 20pt;
  }
  h3{
    font-size: 18pt;
  }
</style>

<style>
#TOC {
top:5%;
}
.list-group-item.active, .list-group-item.active:focus,.list-group-item.active:hover {
background-color: skyblue;
color: black;
border-color: gray;
}
</style>

<br>

> [2조 GITHUB](https://github.com/tmdals5252/Statistics-Network-Analysis/ "2조 깃허브 자료 및 코드 모음.")

---

<br>

```{r, include = FALSE}
library(multilinguer)
library(stringr) 
library(wordcloud2) 
library(KoNLP)
library(wordcloud)
library(RColorBrewer)
library(tidyverse)
library(ggfortify)
library(ggpubr)
library(ggthemes)
library(olsrr)
library(ggplot2) 
library(dplyr) 
library(tm)
library(magrittr)
library(patchwork)
library(GGally)
library(gridExtra)

```


---

<br>

# <1> 개요 {-}

<br>

<div class="warning" style='padding:0.1em; background-color:#F0F8FF; color:#000000'>
<span>
<p style='margin-top:1em; text-align:center'>
<b></b></p>
<p style='margin-left:1em;'>

## 1. 주제 : **반도체 특허 분석 및 시각자료 제공** {-}

기업별 반도체 특허를 시각자료로 제공하고 분석한다

<br>

## 2. 대상 {-}
- <span style="color: #6A5ACD">특허를 내는 기업</span>

- <span style="color: #6A5ACD">변리사</span>

- <span style="color: #6A5ACD">특허청 공무원</span>

<br>

## 3. 선정 기업 및 반도체 {-}
- 선정 기업 : LG, SAMSUNG, SK

- 반도체
    - **Display**
      <br>
      컴퓨터로 처리된 내용을 브라운관에 보여주는 출력장치
      
    - **Led** (Light-Emitting Diode)
      <br>
      전기 에너지를 빛으로 변환시키는 광반도체
      
    - **RAM** (Random Access Memory)
      <br>
      기억된 정보를 읽어내기도 하고 다른 정보를 기억시킬 수도 있는 메모리
       
    - **Transistor**
      <br>
      전류나 전압 흐름을 조절하여 신호를 증폭하고, 스위치 역할 등을 수행하는 반도체소자
    
<br>

## 4. 기대 효과 {-}
- 기업 Issue
    - 어느 기업이, 어느 부품에서 특허를 많이 가지고 있는지 알 수 있다.

- 반도체 Issue
    - 반도체 내에서 어떤 부품이 issue가 되는지 알 수 있다.

- 경쟁력 향상
    - 각 기업이 가지고 있는 특허 중 개선해야 할 부분을 파악하여 경쟁력 향상되는데 도움이 된다.

</p></span>
</div>

<br>

---

<br>

---

<br>

# <2> Data {-}

<br>

<div class="warning" style='padding:0.1em; background-color:#F0F8FF; color:#000000'>
<span>
<p style='margin-top:1em; text-align:center'>
<b></b></p>
<p style='margin-left:1em;'>

## 1. Data 수집 {-}
Kipris 특허청 특허정보검색서비스

<br>

[![kipris 로고](http://www.e-patentnews.com/imgdata/e-patentnews_com/202206/2022062425208055.png)](http://www.kipris.or.kr/khome/main.jsp)

<br>

## 2. DE {-}

  1. 분석을 진행할 변수 열 선택 (5개의 변수)
  <br>
    - 발명의 명칭, 출원인, 출원연도, 심사진행 상태, 요약
        
  2. 출원인을 기준으로 반도체 부품별 데이터 구분
  <br>
    - 3개 기업 x 4개 반도체
    - 총 12개 데이터 생성
    
<br>
    
## 3. DV {-}

  1. 워드 클라우드 시각화
  <br>
    - 발명의 명칭 변수 사용, 단어의 빈도 분석
    <br>    -> 해당 부품의 특허에서 가장 많이 언급되는 단어 파악
    - 요약 변수 사용, 단어의 빈도 분석
    <br>    -> 해당 부품의 특허에서 가장 많이 언급되는 단어 파악

<br>
  2. 심사 진행상태 비율 시각화
    <br>
    - 심사 진행 상태 변수를 사용
      - 각 기업이 각 부품 별 가지고 있는 특허의 등록결정, 등록거절, 취하, 포기 등 비율 시각화

<br>
  3. 각 부품별 기업의 특허 개수 비율 시각화
    <br>
    - 해당 부품에서 가장 많은 특허를 가진 기업 파악

<br>   
  4. 특허 추이 시각화
    <br>
    - 연도별 심사 진행 상태의 비율 추이 시각화
    <br>
    - 1의 워드클라우드 키워드 중 상위 키워드를 선별하여 연도별 키워드 빈도수의 추이 시각화

<br>
</p></span>
</div>

<br>

---

<br>

---

<br>

# <3> 기업별 워드클라우드 {-}

<br>

## 1. LG {-}

<br>

>

### **Display** {-}

```{r, include = FALSE}
##LG dis
dis_LG <- file("C:/Users/dnjs1/Downloads/Rr/dis_n(LG).txt")
dis_LG_r<-readLines(dis_LG)
str(dis_LG_r)
head(dis_LG_r)
```


```{r, include = FALSE}
#명사 추출

exNouns<-function(x){
  paste(extractNoun(as.character(x)), collpase= " ")
}


d_L_r<- sapply(dis_LG_r, exNouns)
d_L_r[2]
```


```{r, include = FALSE}
#말뭉치 Corpus 생성

d_L_r_cpus<-Corpus(VectorSource(d_L_r))
d_L_r_cpus
```


```{r, include = FALSE}
#데이터 전처리

d_L_r_cpus_prepro<-tm_map(d_L_r_cpus,removePunctuation) #문장부호제거

d_L_r_cpus_prepro<-tm_map(d_L_r_cpus_prepro,removeNumbers) #숫자 제거

d_L_r_cpus_prepro<-tm_map(d_L_r_cpus_prepro,tolower) #영문자 소문자 변경

d_L_r_cpus_prepro<-tm_map(d_L_r_cpus_prepro,removeWords, stopwords('english')) #불용어(for, very, and, of, are) 제거


#전처리 결과 확인
inspect(d_L_r_cpus_prepro)
```


```{r, include = FALSE}
#단어 선별(1음절 = 2byte, 2음절 ~ 8음절)
d_L_r_cpus_prepro_term<-TermDocumentMatrix(d_L_r_cpus_prepro, control = list(wordLengths=c(4,16)))

d_L_r_cpus_prepro_term

#matrix -> data.frame으로 변경
d_L_r_cpus_df<-as.data.frame(as.matrix(d_L_r_cpus_prepro_term))

dim(d_L_r_cpus_df)

#단어 출현 빈도수 구하기

wordResult<- sort(rowSums(d_L_r_cpus_df), decreasing = T)
wordResult
```

```{r, include = FALSE}
#워드 클라우드 시각화
word_names<-names(wordResult)
wordcloud(names(wordResult[1:30]),wordResult[1:30]) # 상위 30개만 뽑아서 추출

#단어 이름과 빈도수로 df 생성
word_df<-data.frame(word = names(wordResult[1:40]), freq= wordResult[1:40])

#단어 색상과 글꼴 지정
pal <- brewer.pal(12, "Paired") #12가지 색상
windowsFonts(malgun=windowsFont("맑은 고딕"))
```


```{r, echo=F}
#단어 구름 시각화
x11() #별도의 창을 띄우는 함수
wordcloud(word_df$word, word_df$freq, scale= c(5,1), min.freq=3, random.order=F, rot.per =.1, colors = pal, family= "malgun")

```

<br>

---

<br>

>

### **Led** {-}

```{r, include = FALSE}
led_LG <- file("C:/Users/dnjs1/Downloads/Rr/led(LG).txt")
led_LG_r<-readLines(led_LG)
str(led_LG_r)
head(led_LG_r)
```

<br>

```{r, include = FALSE}
#명사추출

exNouns<-function(x){
  paste(extractNoun(as.character(x)), collpase= " ")
}


l_L_r<- sapply(led_LG_r, exNouns)
l_L_r[2]

```


<br>

```{r, include = FALSE}
#말뭉치 corpus 생성

l_L_r_cpus<-Corpus(VectorSource(l_L_r))
l_L_r_cpus

```

<br>

```{r, include = FALSE}
# 데이터 전처리 및 결과 확인

l_L_r_cpus_prepro<-tm_map(l_L_r_cpus,removePunctuation) #문장부호제거

l_L_r_cpus_prepro<-tm_map(l_L_r_cpus_prepro,removeNumbers) #숫자 제거

l_L_r_cpus_prepro<-tm_map(l_L_r_cpus_prepro,tolower) #영문자 소문자 변경

l_L_r_cpus_prepro<-tm_map(l_L_r_cpus_prepro,removeWords, stopwords('english')) #불용어(for, very, and, of, are) 제거


#전처리 결과 확인
inspect(l_L_r_cpus_prepro)

```

<br>

```{r, include = FALSE}
#단어 선별(1음절 = 2byte, 2음절 ~ 8음절)
l_L_r_cpus_prepro_term<-TermDocumentMatrix(l_L_r_cpus_prepro, control = list(wordLengths=c(4,16)))

l_L_r_cpus_prepro_term

#matrix -> data.frame으로 변경
l_L_r_cpus_df<-as.data.frame(as.matrix(l_L_r_cpus_prepro_term))

dim(l_L_r_cpus_df)

#단어 출현 빈도수 구하기

wordResult<- sort(rowSums(l_L_r_cpus_df), decreasing = T)
wordResult
```

<br>

```{r, include = FALSE}
#워드 클라우드 시각화
word_names<-names(wordResult)
wordcloud(names(wordResult[1:40]),wordResult[1:40]) # 상위 30개만 뽑아서 추출

#단어 이름과 빈도수로 df 생성
word_df<-data.frame(word = names(wordResult[1:40]), freq= wordResult[1:40])

#단어 색상과 글꼴 지정
pal <- brewer.pal(12, "Paired") #12가지 색상
windowsFonts(malgun=windowsFont("맑은 고딕"))
```


```{r, echo=F}
#단어 구름 시각화
x11() #별도의 창을 띄우는 함수
wordcloud(word_df$word, word_df$freq, scale= c(5,1), min.freq=3, random.order=F, rot.per =.1, colors = pal, family= "malgun")

```

<br>

---

<br>

>

### **Ram** {-}

```{r, include = FALSE}
RAM_LG <- file("C:/Users/dnjs1/Downloads/Rr/RAM(LG).txt")
RAM_LG_r<-readLines(RAM_LG)
str(RAM_LG_r)
head(RAM_LG_r)

```

```{r, include = FALSE}
#명사 추출

exNouns<-function(x){
  paste(extractNoun(as.character(x)), collpase= " ")
}


r_L_r<- sapply(RAM_LG_r, exNouns)
r_L_r[2]


#말뭉치 Corpus 생성

r_L_r_cpus<-Corpus(VectorSource(r_L_r))
r_L_r_cpus


#데이터 전처리

r_L_r_cpus_prepro<-tm_map(r_L_r_cpus,removePunctuation) #문장부호제거

r_L_r_cpus_prepro<-tm_map(r_L_r_cpus_prepro,removeNumbers) #숫자 제거

r_L_r_cpus_prepro<-tm_map(r_L_r_cpus_prepro,tolower) #영문자 소문자 변경

r_L_r_cpus_prepro<-tm_map(r_L_r_cpus_prepro,removeWords, stopwords('english')) #불용어(for, very, and, of, are) 제거


#전처리 결과 확인
inspect(r_L_r_cpus_prepro)


#단어 선별(1음절 = 2byte, 2음절 ~ 8음절)
r_L_r_cpus_prepro_term<-TermDocumentMatrix(r_L_r_cpus_prepro, control = list(wordLengths=c(4,16)))

r_L_r_cpus_prepro_term

#matrix -> data.frame으로 변경
r_L_r_cpus_df<-as.data.frame(as.matrix(r_L_r_cpus_prepro_term))

dim(r_L_r_cpus_df)

#단어 출현 빈도수 구하기

wordResult<- sort(rowSums(r_L_r_cpus_df), decreasing = T)
wordResult


#워드 클라우드 시각화
word_names<-names(wordResult)
wordcloud(names(wordResult[1:40]),wordResult[1:40]) # 상위 40개만 뽑아서 추출

#단어 이름과 빈도수로 df 생성
word_df<-data.frame(word = names(wordResult[1:30]), freq= wordResult[1:30])

#단어 색상과 글꼴 지정
pal <- brewer.pal(12, "Paired") #12가지 색상
windowsFonts(malgun=windowsFont("맑은 고딕"))
```


```{r, echo=F}
#단어 구름 시각화
x11() #별도의 창을 띄우는 함수
wordcloud(word_df$word, word_df$freq, scale= c(5,1), min.freq=3, random.order=F, rot.per =.1, colors = pal, family= "malgun")

```


<br>

---

<br>

>

### **Transistor** {-}

```{r, include = FALSE}
Tran_LG <- file("C:/Users/dnjs1/Downloads/Rr/Transistor(LG).txt")
Tran_LG_r<-readLines(Tran_LG)
str(Tran_LG_r)
head(Tran_LG_r)

```

```{r, include = FALSE}
#명사 추출

exNouns<-function(x){
  paste(extractNoun(as.character(x)), collpase= " ")
}


t_L_r<- sapply(Tran_LG_r, exNouns)
t_L_r[2]


#말뭉치 Corpus 생성

t_L_r_cpus<-Corpus(VectorSource(t_L_r))
t_L_r_cpus


#데이터 전처리

t_L_r_cpus_prepro<-tm_map(t_L_r_cpus,removePunctuation) #문장부호제거

t_L_r_cpus_prepro<-tm_map(t_L_r_cpus_prepro,removeNumbers) #숫자 제거

t_L_r_cpus_prepro<-tm_map(t_L_r_cpus_prepro,tolower) #영문자 소문자 변경

t_L_r_cpus_prepro<-tm_map(t_L_r_cpus_prepro,removeWords, stopwords('english')) #불용어(for, very, and, of, are) 제거


#전처리 결과 확인
inspect(t_L_r_cpus_prepro)


#단어 선별(1음절 = 2byte, 2음절 ~ 8음절)
t_L_r_cpus_prepro_term<-TermDocumentMatrix(t_L_r_cpus_prepro, control = list(wordLengths=c(4,16)))

t_L_r_cpus_prepro_term

#matrix -> data.frame으로 변경
t_L_r_cpus_df<-as.data.frame(as.matrix(t_L_r_cpus_prepro_term))

dim(t_L_r_cpus_df)

#단어 출현 빈도수 구하기

wordResult<- sort(rowSums(t_L_r_cpus_df), decreasing = T)
wordResult


#워드 클라우드 시각화
word_names<-names(wordResult)
wordcloud(names(wordResult[1:40]),wordResult[1:40]) # 상위 40개만 뽑아서 추출

#단어 이름과 빈도수로 df 생성
word_df<-data.frame(word = names(wordResult[1:40]), freq= wordResult[1:40])

#단어 색상과 글꼴 지정
pal <- brewer.pal(12, "Paired") #12가지 색상
windowsFonts(malgun=windowsFont("맑은 고딕"))
```


```{r, echo=F}
#단어 구름 시각화
x11() #별도의 창을 띄우는 함수
wordcloud(word_df$word, word_df$freq, scale= c(5,1), min.freq=3, random.order=F, rot.per =.1, colors = pal, family= "malgun")

```

<br>

---

<br>

---

<br>

## 2. Sansung {-}

<br>

>

### ** Display** {-}

```{r, include = FALSE}
##Samsung dis

dis_s <- file("C:/Users/dnjs1/Downloads/Rr/dis_sam.txt")
dis_s_r<-readLines(dis_s)
str(dis_s_r)
head(dis_s_r)

#명사 추출

exNouns<-function(x){
  paste(extractNoun(as.character(x)), collpase= " ")
}


d_s_r<- sapply(dis_s_r, exNouns)
d_s_r[2]


#말뭉치 Corpus 생성

d_s_r_cpus<-Corpus(VectorSource(d_s_r))
d_s_r_cpus


#데이터 전처리

d_s_r_cpus_prepro<-tm_map(d_s_r_cpus,removePunctuation) #문장부호제거

d_s_r_cpus_prepro<-tm_map(d_s_r_cpus_prepro,removeNumbers) #숫자 제거

d_s_r_cpus_prepro<-tm_map(d_s_r_cpus_prepro,tolower) #영문자 소문자 변경

d_s_r_cpus_prepro<-tm_map(d_s_r_cpus_prepro,removeWords, stopwords('english')) #불용어(for, very, and, of, are) 제거


#전처리 결과 확인
inspect(d_s_r_cpus_prepro)


#단어 선별(1음절 = 2byte, 2음절 ~ 8음절)
d_s_r_cpus_prepro_term<-TermDocumentMatrix(d_s_r_cpus_prepro, control = list(wordLengths=c(4,16)))

d_s_r_cpus_prepro_term

#matrix -> data.frame으로 변경
d_s_r_cpus_df<-as.data.frame(as.matrix(d_s_r_cpus_prepro_term))

dim(d_s_r_cpus_df)

#단어 출현 빈도수 구하기

wordResult<- sort(rowSums(d_s_r_cpus_df), decreasing = T)
wordResult


#워드 클라우드 시각화
word_names<-names(wordResult)
wordcloud(names(wordResult[1:30]),wordResult[1:30]) # 상위 30개만 뽑아서 추출

#단어 이름과 빈도수로 df 생성
word_df<-data.frame(word = names(wordResult[1:40]), freq= wordResult[1:40])

#단어 색상과 글꼴 지정
pal <- brewer.pal(12, "Paired") #12가지 색상
windowsFonts(malgun=windowsFont("맑은 고딕"))
```


```{r, echo=F}
#단어 구름 시각화
x11() #별도의 창을 띄우는 함수
wordcloud(word_df$word, word_df$freq, scale= c(5,1), min.freq=3, random.order=F, rot.per =.1, colors = pal, family= "malgun")


```

<br>

---

<br>

>

### **LED** {-}

```{r, include = FALSE}
##samsung led
l_sam <- file("C:/Users/dnjs1/Downloads/Rr/led_sam.txt")
l_sam_r<-readLines(l_sam)
str(l_sam_r)
head(l_sam_r)

#명사 추출

exNouns<-function(x){
  paste(extractNoun(as.character(x)), collpase= " ")
}


l_s_r<- sapply(l_sam_r, exNouns)
l_s_r[2]


#말뭉치 Corpus 생성

l_s_r_cpus<-Corpus(VectorSource(l_s_r))
l_s_r_cpus


#데이터 전처리

l_s_r_cpus_prepro<-tm_map(l_s_r_cpus,removePunctuation) #문장부호제거

l_s_r_cpus_prepro<-tm_map(l_s_r_cpus_prepro,removeNumbers) #숫자 제거

l_s_r_cpus_prepro<-tm_map(l_s_r_cpus_prepro,tolower) #영문자 소문자 변경

l_s_r_cpus_prepro<-tm_map(l_s_r_cpus_prepro,removeWords, stopwords('english')) #불용어(for, very, and, of, are) 제거


#전처리 결과 확인
inspect(l_s_r_cpus_prepro)


#단어 선별(1음절 = 2byte, 2음절 ~ 8음절)
l_s_r_cpus_prepro_term<-TermDocumentMatrix(l_s_r_cpus_prepro, control = list(wordLengths=c(4,16)))

l_s_r_cpus_prepro_term

#matrix -> data.frame으로 변경
l_s_r_cpus_df<-as.data.frame(as.matrix(l_s_r_cpus_prepro_term))

dim(l_s_r_cpus_df)

#단어 출현 빈도수 구하기

wordResult<- sort(rowSums(l_s_r_cpus_df), decreasing = T)
wordResult


#워드 클라우드 시각화
word_names<-names(wordResult)
wordcloud(names(wordResult[1:40]),wordResult[1:40]) # 상위 30개만 뽑아서 추출

#단어 이름과 빈도수로 df 생성
word_df<-data.frame(word = names(wordResult[1:40]), freq= wordResult[1:40])

#단어 색상과 글꼴 지정
pal <- brewer.pal(12, "Paired") #12가지 색상
windowsFonts(malgun=windowsFont("맑은 고딕"))
brewer.pal(12)
```


```{r, echo=F}
#단어 구름 시각화
x11() #별도의 창을 띄우는 함수
wordcloud(word_df$word, word_df$freq, scale= c(5,1), min.freq=3, random.order=F, rot.per =.1, colors = pal, family= "malgun")

```

<br>

---

<br>

>

### **RAM** {-}

```{r, include = FALSE}
##samsung RAM

r_sam <- file("C:/Users/dnjs1/Downloads/Rr/ram_sam.txt")
r_sam_r<-readLines(r_sam)
str(r_sam_r)
head(r_sam_r)

#명사 추출

exNouns<-function(x){
  paste(extractNoun(as.character(x)), collpase= " ")
}


r_s_r<- sapply(r_sam_r, exNouns)
r_s_r[2]


#말뭉치 Corpus 생성

r_s_r_cpus<-Corpus(VectorSource(r_s_r))
r_s_r_cpus


#데이터 전처리

r_s_r_cpus_prepro<-tm_map(r_s_r_cpus,removePunctuation) #문장부호제거

r_s_r_cpus_prepro<-tm_map(r_s_r_cpus_prepro,removeNumbers) #숫자 제거

r_s_r_cpus_prepro<-tm_map(r_s_r_cpus_prepro,tolower) #영문자 소문자 변경

r_s_r_cpus_prepro<-tm_map(r_s_r_cpus_prepro,removeWords, stopwords('english')) #불용어(for, very, and, of, are) 제거


#전처리 결과 확인
inspect(r_s_r_cpus_prepro)


#단어 선별(1음절 = 2byte, 2음절 ~ 8음절)
r_s_r_cpus_prepro_term<-TermDocumentMatrix(r_s_r_cpus_prepro, control = list(wordLengths=c(4,16)))

r_s_r_cpus_prepro_term

#matrix -> data.frame으로 변경
r_s_r_cpus_df<-as.data.frame(as.matrix(r_s_r_cpus_prepro_term))

dim(r_s_r_cpus_df)

#단어 출현 빈도수 구하기

wordResult<- sort(rowSums(r_s_r_cpus_df), decreasing = T)
wordResult


#워드 클라우드 시각화
word_names<-names(wordResult)
wordcloud(names(wordResult[1:40]),wordResult[1:40]) # 상위 40개만 뽑아서 추출

#단어 이름과 빈도수로 df 생성
word_df<-data.frame(word = names(wordResult[1:30]), freq= wordResult[1:30])

#단어 색상과 글꼴 지정
pal <- brewer.pal(12, "Paired") #12가지 색상
windowsFonts(malgun=windowsFont("맑은 고딕"))
```


```{r, echo=F}
#단어 구름 시각화
x11() #별도의 창을 띄우는 함수
wordcloud(word_df$word, word_df$freq, scale= c(5,1), min.freq=3, random.order=F, rot.per =.1, colors = pal, family= "malgun")


```

<br>

---

<br>

>

### **Transistor** {-}

```{r, include = FALSE}
##samsung transistor


tran_sam <- file("C:/Users/dnjs1/Downloads/Rr/tran_sam.txt")
tran_sam_r<-readLines(tran_sam)
str(tran_sam_r)
head(tran_sam_r)

#명사 추출

exNouns<-function(x){
  paste(extractNoun(as.character(x)), collpase= " ")
}


t_s_r<- sapply(tran_sam_r, exNouns)
t_s_r[2]


#말뭉치 Corpus 생성

t_s_r_cpus<-Corpus(VectorSource(t_s_r))
t_s_r_cpus


#데이터 전처리

t_s_r_cpus_prepro<-tm_map(t_s_r_cpus,removePunctuation) #문장부호제거

t_s_r_cpus_prepro<-tm_map(t_s_r_cpus_prepro,removeNumbers) #숫자 제거

t_s_r_cpus_prepro<-tm_map(t_s_r_cpus_prepro,tolower) #영문자 소문자 변경

t_s_r_cpus_prepro<-tm_map(t_s_r_cpus_prepro,removeWords, stopwords('english')) #불용어(for, very, and, of, are) 제거


#전처리 결과 확인
inspect(t_s_r_cpus_prepro)


#단어 선별(1음절 = 2byte, 2음절 ~ 8음절)
t_s_r_cpus_prepro_term<-TermDocumentMatrix(t_s_r_cpus_prepro, control = list(wordLengths=c(4,16)))

t_s_r_cpus_prepro_term

#matrix -> data.frame으로 변경
t_s_r_cpus_df<-as.data.frame(as.matrix(t_s_r_cpus_prepro_term))

dim(t_s_r_cpus_df)

#단어 출현 빈도수 구하기

wordResult<- sort(rowSums(t_s_r_cpus_df), decreasing = T)
wordResult


#워드 클라우드 시각화
word_names<-names(wordResult)
wordcloud(names(wordResult[1:40]),wordResult[1:40]) # 상위 40개만 뽑아서 추출

#단어 이름과 빈도수로 df 생성
word_df<-data.frame(word = names(wordResult[1:40]), freq= wordResult[1:40])

#단어 색상과 글꼴 지정
pal <- brewer.pal(12, "Paired") #12가지 색상
windowsFonts(malgun=windowsFont("맑은 고딕"))
```


```{r, echo=F}
#단어 구름 시각화
x11() #별도의 창을 띄우는 함수
wordcloud(word_df$word, word_df$freq, scale= c(5,1), min.freq=3, random.order=F, rot.per =.1, colors = pal, family= "malgun")

```

<br>

---

<br>

---

<br>

## 3. SK {-}

<br>

>

### ** Display** {-}

```{r, include = FALSE}
##sk dis

dis_sk <- file("C:/Users/dnjs1/Downloads/Rr/dis_sk.txt")
dis_sk_r<-readLines(dis_sk)
str(dis_sk_r)
head(dis_sk_r)

#명사 추출

exNouns<-function(x){
  paste(extractNoun(as.character(x)), collpase= " ")
}


d_k_r<- sapply(dis_sk_r, exNouns)
d_k_r[2]


#말뭉치 Corpus 생성

d_k_r_cpus<-Corpus(VectorSource(d_k_r))
d_k_r_cpus


#데이터 전처리

d_k_r_cpus_prepro<-tm_map(d_k_r_cpus,removePunctuation) #문장부호제거

d_k_r_cpus_prepro<-tm_map(d_k_r_cpus_prepro,removeNumbers) #숫자 제거

d_k_r_cpus_prepro<-tm_map(d_k_r_cpus_prepro,tolower) #영문자 소문자 변경

d_k_r_cpus_prepro<-tm_map(d_k_r_cpus_prepro,removeWords, stopwords('english')) #불용어(for, very, and, of, are) 제거


#전처리 결과 확인
inspect(d_k_r_cpus_prepro)


#단어 선별(1음절 = 2byte, 2음절 ~ 8음절)
d_k_r_cpus_prepro_term<-TermDocumentMatrix(d_k_r_cpus_prepro, control = list(wordLengths=c(4,16)))

d_k_r_cpus_prepro_term

#matrix -> data.frame으로 변경
d_k_r_cpus_df<-as.data.frame(as.matrix(d_k_r_cpus_prepro_term))

dim(d_k_r_cpus_df)

#단어 출현 빈도수 구하기

wordResult<- sort(rowSums(d_k_r_cpus_df), decreasing = T)
wordResult


#워드 클라우드 시각화
word_names<-names(wordResult)
wordcloud(names(wordResult[1:30]),wordResult[1:30]) # 상위 30개만 뽑아서 추출

#단어 이름과 빈도수로 df 생성
word_df<-data.frame(word = names(wordResult[1:40]), freq= wordResult[1:40])

#단어 색상과 글꼴 지정
pal <- brewer.pal(12, "Paired") #12가지 색상
windowsFonts(malgun=windowsFont("맑은 고딕"))
```


```{r, echo=F}
#단어 구름 시각화
x11() #별도의 창을 띄우는 함수
wordcloud(word_df$word, word_df$freq, scale= c(5,1), min.freq=3, random.order=F, rot.per =.1, colors = pal, family= "malgun")
```

<br>

---

<br>

>

### **LED** {-}

```{r, include = FALSE}
##sk led

led_sk <- file("C:/Users/dnjs1/Downloads/Rr/led_sk.txt")
led_sk_r<-readLines(led_sk)
str(led_sk_r)
head(led_sk_r)

#명사 추출

exNouns<-function(x){
  paste(extractNoun(as.character(x)), collpase= " ")
}


l_k_r<- sapply(led_sk_r, exNouns)
l_k_r[2]


#말뭉치 Corpus 생성

l_k_r_cpus<-Corpus(VectorSource(l_k_r))
l_k_r_cpus


#데이터 전처리

l_k_r_cpus_prepro<-tm_map(l_k_r_cpus,removePunctuation) #문장부호제거

l_k_r_cpus_prepro<-tm_map(l_k_r_cpus_prepro,removeNumbers) #숫자 제거

l_k_r_cpus_prepro<-tm_map(l_k_r_cpus_prepro,tolower) #영문자 소문자 변경

l_k_r_cpus_prepro<-tm_map(l_k_r_cpus_prepro,removeWords, stopwords('english')) #불용어(for, very, and, of, are) 제거


#전처리 결과 확인
inspect(l_k_r_cpus_prepro)


#단어 선별(1음절 = 2byte, 2음절 ~ 8음절)
l_k_r_cpus_prepro_term<-TermDocumentMatrix(l_k_r_cpus_prepro, control = list(wordLengths=c(4,16)))

l_k_r_cpus_prepro_term

#matrix -> data.frame으로 변경
l_k_r_cpus_df<-as.data.frame(as.matrix(l_k_r_cpus_prepro_term))

dim(l_k_r_cpus_df)

#단어 출현 빈도수 구하기

wordResult<- sort(rowSums(l_k_r_cpus_df), decreasing = T)
wordResult


#워드 클라우드 시각화
word_names<-names(wordResult)
wordcloud(names(wordResult[1:40]),wordResult[1:40]) # 상위 30개만 뽑아서 추출

#단어 이름과 빈도수로 df 생성
word_df<-data.frame(word = names(wordResult[1:40]), freq= wordResult[1:40])

#단어 색상과 글꼴 지정
pal <- brewer.pal(12, "Paired") #12가지 색상
windowsFonts(malgun=windowsFont("맑은 고딕"))
```


```{r, echo=F}
#단어 구름 시각화
x11() #별도의 창을 띄우는 함수
wordcloud(word_df$word, word_df$freq, scale= c(5,1), min.freq=3, random.order=F, rot.per =.1, colors = pal, family= "malgun")
```

<br>

---

<br>

>

### **RAM** {-}

```{r, include = FALSE}
##sk RAM

ram_sk <- file("C:/Users/dnjs1/Downloads/Rr/ram_sk.txt")
ram_sk_r<-readLines(ram_sk)
str(ram_sk_r)
head(ram_sk_r)

#명사 추출

exNouns<-function(x){
  paste(extractNoun(as.character(x)), collpase= " ")
}


r_k_r<- sapply(ram_sk_r, exNouns)
r_k_r[2]


#말뭉치 Corpus 생성

r_k_r_cpus<-Corpus(VectorSource(r_k_r))
r_k_r_cpus


#데이터 전처리

r_k_r_cpus_prepro<-tm_map(r_k_r_cpus,removePunctuation) #문장부호제거

r_k_r_cpus_prepro<-tm_map(r_k_r_cpus_prepro,removeNumbers) #숫자 제거

r_k_r_cpus_prepro<-tm_map(r_k_r_cpus_prepro,tolower) #영문자 소문자 변경

r_k_r_cpus_prepro<-tm_map(r_k_r_cpus_prepro,removeWords, stopwords('english')) #불용어(for, very, and, of, are) 제거


#전처리 결과 확인
inspect(r_k_r_cpus_prepro)


#단어 선별(1음절 = 2byte, 2음절 ~ 8음절)
r_k_r_cpus_prepro_term<-TermDocumentMatrix(r_k_r_cpus_prepro, control = list(wordLengths=c(4,16)))

r_k_r_cpus_prepro_term

#matrix -> data.frame으로 변경
r_k_r_cpus_df<-as.data.frame(as.matrix(r_k_r_cpus_prepro_term))

dim(r_k_r_cpus_df)

#단어 출현 빈도수 구하기

wordResult<- sort(rowSums(r_k_r_cpus_df), decreasing = T)
wordResult


#워드 클라우드 시각화
word_names<-names(wordResult)
wordcloud(names(wordResult[1:40]),wordResult[1:40]) # 상위 40개만 뽑아서 추출

#단어 이름과 빈도수로 df 생성
word_df<-data.frame(word = names(wordResult[1:30]), freq= wordResult[1:30])

#단어 색상과 글꼴 지정
pal <- brewer.pal(12, "Paired") #12가지 색상
windowsFonts(malgun=windowsFont("맑은 고딕"))
```


```{r, echo=F}
#단어 구름 시각화
x11() #별도의 창을 띄우는 함수
wordcloud(word_df$word, word_df$freq, scale= c(5,1), min.freq=3, random.order=F, rot.per =.1, colors = pal, family= "malgun")
```

<br>

---

<br>

>

### **Transistor** {-}

```{r, include = FALSE}
##sk transistor


Tran_sk <- file("C:/Users/dnjs1/Downloads/Rr/tran_sk.txt")
Tran_sk_r<-readLines(Tran_sk)
str(Tran_sk_r)
head(Tran_sk_r)

#명사 추출

exNouns<-function(x){
  paste(extractNoun(as.character(x)), collpase= " ")
}


t_k_r<- sapply(Tran_sk_r, exNouns)
t_k_r[2]


#말뭉치 Corpus 생성

t_k_r_cpus<-Corpus(VectorSource(t_k_r))
t_k_r_cpus


#데이터 전처리

t_k_r_cpus_prepro<-tm_map(t_k_r_cpus,removePunctuation) #문장부호제거

t_k_r_cpus_prepro<-tm_map(t_k_r_cpus_prepro,removeNumbers) #숫자 제거

t_k_r_cpus_prepro<-tm_map(t_k_r_cpus_prepro,tolower) #영문자 소문자 변경

t_k_r_cpus_prepro<-tm_map(t_k_r_cpus_prepro,removeWords, stopwords('english')) #불용어(for, very, and, of, are) 제거


#전처리 결과 확인
inspect(t_k_r_cpus_prepro)


#단어 선별(1음절 = 2byte, 2음절 ~ 8음절)
t_k_r_cpus_prepro_term<-TermDocumentMatrix(t_k_r_cpus_prepro, control = list(wordLengths=c(4,16)))

t_k_r_cpus_prepro_term

#matrix -> data.frame으로 변경
t_k_r_cpus_df<-as.data.frame(as.matrix(t_k_r_cpus_prepro_term))

dim(t_k_r_cpus_df)

#단어 출현 빈도수 구하기

wordResult<- sort(rowSums(t_k_r_cpus_df), decreasing = T)
wordResult


#워드 클라우드 시각화
word_names<-names(wordResult)
wordcloud(names(wordResult[1:40]),wordResult[1:40]) # 상위 40개만 뽑아서 추출

#단어 이름과 빈도수로 df 생성
word_df<-data.frame(word = names(wordResult[1:40]), freq= wordResult[1:40])

#단어 색상과 글꼴 지정
pal <- brewer.pal(12, "Paired") #12가지 색상
windowsFonts(malgun=windowsFont("맑은 고딕"))
```


```{r, echo=F}
#단어 구름 시각화
x11() #별도의 창을 띄우는 함수
wordcloud(word_df$word, word_df$freq, scale= c(5,1), min.freq=3, random.order=F, rot.per =.1, colors = pal, family= "malgun")


```

<br>

---

<br>

---

<br>

# <4> 특허 심사 진행 상태 {-}

<br>

## 1. LG {-}

```{r, include = FALSE}
#데이터 불러오기 및 전처리
display_lg <- read.csv("C:/Users/dnjs1/Downloads/Rr/display(LG).csv", header=T)
display_lg <- display_lg[!(display_lg$심사진행상태 == ""), ]
display_lg$심사진행상태 <- gsub("\\(.*?\\)","",display_lg$심사진행상태)
#등록결정/거절결정/포기/취하(심사미청구)/기타=원결정유지

display_lg$심사진행상태 <- substr(display_lg$심사진행상태, 1, 5)
display_lg$심사진행상태 <- str_trim(display_lg$심사진행상태)

#각 항목별 개수 파악 (등록결정=1, 거절결정=2, 포기=3, 취하=4, 기타=5(원결정유지) )
display_lg_1 <- nrow(display_lg[display_lg$심사진행상태 == "등록결정",])
display_lg_1 <- nrow(display_lg[display_lg$심사진행상태 == "등록결정",])
display_lg_2 <- nrow(display_lg[display_lg$심사진행상태 == "거절결정",])
display_lg_3 <- nrow(display_lg[display_lg$심사진행상태 == "포기",])
display_lg_4 <- nrow(display_lg[display_lg$심사진행상태 == "취하",])
display_lg_5 <- nrow(display_lg[display_lg$심사진행상태 == "원결정유지",])
display_lg <- nrow(display_lg)

#lg사 display 관련 특허건 개수
display_lg #39209 #lg사 display 관련 특허 건 수
display_lg_1 #26915 #lg사 display 관련 특허 중 등록결정 건 개수 (재심사 후 등록결정건 포함)
display_lg_2 #2996 #lg사 display 관련 특허 중 거절결정 건 개수(거절결정 후 재심사중인 건 포함)
display_lg_3 #54 #lg사 display 관련 특허 중 포기(미납) 건 개수
display_lg_4 #8755 #lg사 display 관련 특허 중 취하(심사미청구) 건 개수
display_lg_5 #422 #lg사 display 관련 특허 중 원결정유지 건 개수

#lg사 display 관련 특허건 비율
display_lg_1_per <- display_lg_1 / display_lg 
display_lg_2_per <- display_lg_2 / display_lg
display_lg_3_per <- display_lg_3 / display_lg 
display_lg_4_per <- display_lg_4 / display_lg 
display_lg_5_per <- display_lg_5 / display_lg #원결정유지건은 제외
display_lg_1_per #0.6864495
display_lg_2_per #0.07641103
display_lg_3_per #0.001377235
display_lg_4_per #0.2232906

#lg사 display 관련 특허건
display_lg <- data.frame("심사진행상태"=c("등록결정","거절결정","포기","취하"),
                         "비율"=c(display_lg_1_per,display_lg_2_per,display_lg_3_per,display_lg_4_per))
```


```{r, include = FALSE}
## Lg Led
#데이터 불러오기 및 전처리
led_lg <- read.csv("C:/Users/dnjs1/Downloads/Rr/LED(LG).csv", header=T)
led_lg <- led_lg[!(led_lg$심사진행상태 == ""), ]
led_lg$심사진행상태 <- gsub("\\(.*?\\)","",led_lg$심사진행상태)
#등록결정/거절결정/포기/취하(심사미청구)/기타=원결정유지

led_lg$심사진행상태 <- substr(led_lg$심사진행상태, 1, 5)
led_lg$심사진행상태 <- str_trim(led_lg$심사진행상태)

#각 항목별 개수 파악 (등록결정=1, 거절결정=2, 포기=3, 취하=4, 기타=5(원결정유지) )
led_lg_1 <- nrow(led_lg[led_lg$심사진행상태 == "등록결정",])
led_lg_1 <- nrow(led_lg[led_lg$심사진행상태 == "등록결정",])
led_lg_2 <- nrow(led_lg[led_lg$심사진행상태 == "거절결정",])
led_lg_3 <- nrow(led_lg[led_lg$심사진행상태 == "포기",])
led_lg_4 <- nrow(led_lg[led_lg$심사진행상태 == "취하",])
led_lg_5 <- nrow(led_lg[led_lg$심사진행상태 == "원결정유지",])
led_lg <- nrow(led_lg)

#lg사 led 관련 특허건 개수
led_lg #1056 #lg사 led 관련 특허 건 수
led_lg_1 #696 #lg사 led 관련 특허 중 등록결정 건 개수 (재심사 후 등록결정건 포함)
led_lg_2 #160 #lg사 led 관련 특허 중 거절결정 건 개수(거절결정 후 재심사중인 건 포함)
led_lg_3 #5 #lg사 led 관련 특허 중 포기(미납) 건 개수
led_lg_4 #188 #lg사 led 관련 특허 중 취하(심사미청구) 건 개수
led_lg_5 #5 #lg사 led 관련 특허 중 원결정유지 건 개수

#lg사 led 관련 특허건 비율
led_lg_1_per <- led_lg_1 / led_lg 
led_lg_2_per <- led_lg_2 / led_lg
led_lg_3_per <- led_lg_3 / led_lg 
led_lg_4_per <- led_lg_4 / led_lg 
led_lg_5_per <- led_lg_5 / led_lg #원결정유지건은 제외
led_lg_1_per #0.6590909
led_lg_2_per #0.1515152
led_lg_3_per #0.004734848
led_lg_4_per #0.1780303


#lg사 led 관련 특허건
led_lg <- data.frame("심사진행상태"=c("등록결정","거절결정","포기","취하"),
                     "비율"=c(led_lg_1_per,led_lg_2_per,led_lg_3_per,led_lg_4_per))
```


```{r, include = FALSE}
##LG ram
#데이터 불러오기 및 전처리
ram_lg <- read.csv("C:/Users/dnjs1/Downloads/Rr/RAM(LG).csv", header=T)
ram_lg <- ram_lg[!(ram_lg$심사진행상태 == ""), ]
ram_lg$심사진행상태 <- gsub("\\(.*?\\)","",ram_lg$심사진행상태)
#등록결정/거절결정/포기/취하(심사미청구)/기타=원결정유지

ram_lg$심사진행상태 <- substr(ram_lg$심사진행상태, 1, 5)
ram_lg$심사진행상태 <- str_trim(ram_lg$심사진행상태)

#각 항목별 개수 파악 (등록결정=1, 거절결정=2, 포기=3, 취하=4, 기타=5(원결정유지) )
ram_lg_1 <- nrow(ram_lg[ram_lg$심사진행상태 == "등록결정",])
ram_lg_1 <- nrow(ram_lg[ram_lg$심사진행상태 == "등록결정",])
ram_lg_2 <- nrow(ram_lg[ram_lg$심사진행상태 == "거절결정",])
ram_lg_3 <- nrow(ram_lg[ram_lg$심사진행상태 == "포기",])
ram_lg_4 <- nrow(ram_lg[ram_lg$심사진행상태 == "취하",])
ram_lg_5 <- nrow(ram_lg[ram_lg$심사진행상태 == "원결정유지",])
ram_lg <- nrow(ram_lg)

#lg사 ram 관련 특허건 개수
ram_lg #69 #lg사 ram 관련 특허 건 수
ram_lg_1 #36 #lg사 ram 관련 특허 중 등록결정 건 개수 (재심사 후 등록결정건 포함)
ram_lg_2 #5 #lg사 ram 관련 특허 중 거절결정 건 개수(거절결정 후 재심사중인 건 포함)
ram_lg_3 #0 #lg사 ram 관련 특허 중 포기(미납) 건 개수
ram_lg_4 #27 #lg사 ram 관련 특허 중 취하(심사미청구) 건 개수
ram_lg_5 #0 #lg사 ram 관련 특허 중 원결정유지 건 개수

#lg사 ram 관련 특허건 비율
ram_lg_1_per <- ram_lg_1 / ram_lg 
ram_lg_2_per <- ram_lg_2 / ram_lg
ram_lg_3_per <- ram_lg_3 / ram_lg 
ram_lg_4_per <- ram_lg_4 / ram_lg 
ram_lg_5_per <- ram_lg_5 / ram_lg #원결정유지건은 제외
ram_lg_1_per #0.5217391
ram_lg_2_per #0.07246377
ram_lg_3_per #0
ram_lg_4_per #0.3913043


#lg사 ram 관련 특허건
ram_lg <- data.frame("심사진행상태"=c("등록결정","거절결정","포기","취하"),
                     "비율"=c(ram_lg_1_per,ram_lg_2_per,ram_lg_3_per,ram_lg_4_per))
```


```{r, include = FALSE}
##LG transistor
#데이터 불러오기 및 전처리
transistor_lg <- read.csv("C:/Users/dnjs1/Downloads/Rr/Transistor(LG).csv", header=T)
transistor_lg <- transistor_lg[!(transistor_lg$심사진행상태 == ""), ]
transistor_lg$심사진행상태 <- gsub("\\(.*?\\)","",transistor_lg$심사진행상태)
#등록결정/거절결정/포기/취하(심사미청구)/기타=원결정유지


transistor_lg$심사진행상태 <- substr(transistor_lg$심사진행상태, 1, 5)
transistor_lg$심사진행상태 <- str_trim(transistor_lg$심사진행상태)

#각 항목별 개수 파악 (등록결정=1, 거절결정=2, 포기=3, 취하=4, 기타=5(원결정유지) )
transistor_lg_1 <- nrow(transistor_lg[transistor_lg$심사진행상태 == "등록결정",])
transistor_lg_1 <- nrow(transistor_lg[transistor_lg$심사진행상태 == "등록결정",])
transistor_lg_2 <- nrow(transistor_lg[transistor_lg$심사진행상태 == "거절결정",])
transistor_lg_3 <- nrow(transistor_lg[transistor_lg$심사진행상태 == "포기",])
transistor_lg_4 <- nrow(transistor_lg[transistor_lg$심사진행상태 == "취하",])
transistor_lg_5 <- nrow(transistor_lg[transistor_lg$심사진행상태 == "원결정유지",])
transistor_lg <- nrow(transistor_lg)

#lg사 transistor 관련 특허건 개수
transistor_lg 
transistor_lg_1 
transistor_lg_2
transistor_lg_3
transistor_lg_4
transistor_lg_5

#lg사 transistor 관련 특허건 비율
transistor_lg_1_per <- transistor_lg_1 / transistor_lg 
transistor_lg_2_per <- transistor_lg_2 / transistor_lg
transistor_lg_3_per <- transistor_lg_3 / transistor_lg
transistor_lg_4_per <- transistor_lg_4 / transistor_lg
transistor_lg_5_per <- transistor_lg_5 / transistor_lg #원결정유지건은 제외
transistor_lg_1_per 
transistor_lg_2_per 
transistor_lg_3_per 
transistor_lg_4_per 


#lg사 transistor 관련 특허건
transistor_lg <- data.frame("심사진행상태"=c("등록결정","거절결정","포기","취하"),
                            "비율"=c(transistor_lg_1_per,transistor_lg_2_per,transistor_lg_3_per,transistor_lg_4_per))

```



```{r, include = FALSE}
d_l = ggplot(display_lg, aes(x=심사진행상태, y=비율, fill=심사진행상태))+
       geom_bar(mapping=aes(fill=심사진행상태),stat = "identity")+
       geom_label(aes(label=round(비율,3),nudge_y = 1.1)) +
       labs(title = "LG사 display 관련 특허건 비율")

l_l = ggplot(led_lg, aes(x=심사진행상태, y=비율, fill=심사진행상태))+
     geom_bar(mapping=aes(fill=심사진행상태),stat = "identity")+
     geom_label(aes(label=round(비율,3),nudge_y = 1.1)) +
     labs(title = "LG사 led 관련 특허건 비율")

r_l = ggplot(ram_lg, aes(x=심사진행상태, y=비율, fill=심사진행상태))+
       geom_bar(mapping=aes(fill=심사진행상태),stat = "identity")+
       geom_label(aes(label=round(비율,3),nudge_y = 1.1)) +
       labs(title = "LG사 ram 관련 특허건 비율")

t_l = ggplot(transistor_lg, aes(x=심사진행상태, y=비율, fill=심사진행상태))+
       geom_bar(mapping=aes(fill=심사진행상태),stat = "identity")+
       geom_label(aes(label=round(비율,3),nudge_y = 1.1)) +
       labs(title = "LG사 transistor 관련 특허건 비율")
```

```{r, echo=F}
grid.arrange(d_l,l_l,r_l,t_l)
```

<br>

---

<br>

## 2. SAMSUNG {-}
```{r, include = FALSE}
##sam dis
#데이터 불러오기 및 전처리
display_samsung <- read.csv("C:/Users/dnjs1/Downloads/Rr/display_samsung.csv", header=T)
display_samsung <- display_samsung[!(display_samsung$심사진행상태 == ""), ]
display_samsung$심사진행상태 <- gsub("\\(.*?\\)","",display_samsung$심사진행상태)
#등록결정/거절결정/포기/취하(심사미청구)/기타=원결정유지

display_samsung$심사진행상태 <- substr(display_samsung$심사진행상태, 1, 5)
display_samsung$심사진행상태 <- str_trim(display_samsung$심사진행상태)

#각 항목별 개수 파악 (등록결정=1, 거절결정=2, 포기=3, 취하=4, 기타=5(원결정유지) )
display_samsung_1 <- nrow(display_samsung[display_samsung$심사진행상태 == "등록결정",])
display_samsung_1 <- nrow(display_samsung[display_samsung$심사진행상태 == "등록결정",])
display_samsung_2 <- nrow(display_samsung[display_samsung$심사진행상태 == "거절결정",])
display_samsung_3 <- nrow(display_samsung[display_samsung$심사진행상태 == "포기",])
display_samsung_4 <- nrow(display_samsung[display_samsung$심사진행상태 == "취하",])
display_samsung_5 <- nrow(display_samsung[display_samsung$심사진행상태 == "원결정유지",])
display_samsung <- nrow(display_samsung)

#samsung사 display 관련 특허건 개수
display_samsung #43934 #samsung사 display 관련 특허 건 수
display_samsung_1 #27026 #samsung사 display 관련 특허 중 등록결정 건 개수 (재심사 후 등록결정건 포함)
display_samsung_2 #4840 #samsung사 display 관련 특허 중 거절결정 건 개수(거절결정 후 재심사중인 건 포함)
display_samsung_3 #379 #samsung사 display 관련 특허 중 포기(미납) 건 개수
display_samsung_4 #11326 #samsung사 display 관련 특허 중 취하(심사미청구) 건 개수
display_samsung_5 #259 #samsung사 display 관련 특허 중 원결정유지 건 개수

#samsung사 display 관련 특허건 비율
display_samsung_1_per <- display_samsung_1 / display_samsung 
display_samsung_2_per <- display_samsung_2 / display_samsung
display_samsung_3_per <- display_samsung_3 / display_samsung
display_samsung_4_per <- display_samsung_4 / display_samsung
display_samsung_5_per <- display_samsung_5 / display_samsung #원결정유지건은 제외
display_samsung_1_per #0.61515
display_samsung_2_per #0.1101652
display_samsung_3_per #0.008626576
display_samsung_4_per #0.008626576

#samsung사 display 관련 특허건
display_samsung <- data.frame("심사진행상태"=c("등록결정","거절결정","포기","취하"),
                              "비율"=c(display_samsung_1_per,display_samsung_2_per,display_samsung_3_per,display_samsung_4_per))
```


```{r, include = FALSE}
##sam led
#데이터 불러오기 및 전처리
led_samsung <- read.csv("C:/Users/dnjs1/Downloads/Rr/led_samsung.csv", header=T)
led_samsung <- led_samsung[!(led_samsung$심사진행상태 == ""), ]
led_samsung$심사진행상태 <- gsub("\\(.*?\\)","",led_samsung$심사진행상태)
#등록결정/거절결정/포기/취하(심사미청구)/기타=원결정유지

led_samsung$심사진행상태 <- substr(led_samsung$심사진행상태, 1, 5)
led_samsung$심사진행상태 <- str_trim(led_samsung$심사진행상태)

#각 항목별 개수 파악 (등록결정=1, 거절결정=2, 포기=3, 취하=4, 기타=5(원결정유지) )
led_samsung_1 <- nrow(led_samsung[led_samsung$심사진행상태 == "등록결정",])
led_samsung_1 <- nrow(led_samsung[led_samsung$심사진행상태 == "등록결정",])
led_samsung_2 <- nrow(led_samsung[led_samsung$심사진행상태 == "거절결정",])
led_samsung_3 <- nrow(led_samsung[led_samsung$심사진행상태 == "포기",])
led_samsung_4 <- nrow(led_samsung[led_samsung$심사진행상태 == "취하",])
led_samsung_5 <- nrow(led_samsung[led_samsung$심사진행상태 == "원결정유지",])
led_samsung <- nrow(led_samsung)

#samsung사 led 관련 특허건 개수
led_samsung #1453 #samsung사 led 관련 특허 건 수
led_samsung_1 #874 #samsung사 led 관련 특허 중 등록결정 건 개수 (재심사 후 등록결정건 포함)
led_samsung_2 #134 #samsung사 led 관련 특허 중 거절결정 건 개수(거절결정 후 재심사중인 건 포함)
led_samsung_3 #22 #samsung사 led 관련 특허 중 포기(미납) 건 개수
led_samsung_4 #416 #samsung사 led 관련 특허 중 취하(심사미청구) 건 개수
led_samsung_5 #5 #samsung사 led 관련 특허 중 원결정유지 건 개수

#samsung사 led 관련 특허건 비율
led_samsung_1_per <- led_samsung_1 / led_samsung 
led_samsung_2_per <- led_samsung_2 / led_samsung
led_samsung_3_per <- led_samsung_3 / led_samsung
led_samsung_4_per <- led_samsung_4 / led_samsung
led_samsung_5_per <- led_samsung_5 / led_samsung #원결정유지건은 제외
led_samsung_1_per #0.6015141
led_samsung_2_per #0.09222299
led_samsung_3_per #0.01514109
led_samsung_4_per #0.2863042


#samsung사 led 관련 특허건
led_samsung <- data.frame("심사진행상태"=c("등록결정","거절결정","포기","취하"),
                          "비율"=c(led_samsung_1_per,led_samsung_2_per,led_samsung_3_per,led_samsung_4_per))
```


```{r, include = FALSE}
## sam ram
#데이터 불러오기 및 전처리
ram_samsung <- read.csv("C:/Users/dnjs1/Downloads/Rr/ram_samsung.csv", header=T)
ram_samsung <- ram_samsung[!(ram_samsung$심사진행상태 == ""), ]
ram_samsung$심사진행상태 <- gsub("\\(.*?\\)","",ram_samsung$심사진행상태)
#등록결정/거절결정/포기/취하(심사미청구)/기타=원결정유지

ram_samsung$심사진행상태 <- substr(ram_samsung$심사진행상태, 1, 5)
ram_samsung$심사진행상태 <- str_trim(ram_samsung$심사진행상태)

#각 항목별 개수 파악 (등록결정=1, 거절결정=2, 포기=3, 취하=4, 기타=5(원결정유지) )
ram_samsung_1 <- nrow(ram_samsung[ram_samsung$심사진행상태 == "등록결정",])
ram_samsung_1 <- nrow(ram_samsung[ram_samsung$심사진행상태 == "등록결정",])
ram_samsung_2 <- nrow(ram_samsung[ram_samsung$심사진행상태 == "거절결정",])
ram_samsung_3 <- nrow(ram_samsung[ram_samsung$심사진행상태 == "포기",])
ram_samsung_4 <- nrow(ram_samsung[ram_samsung$심사진행상태 == "취하",])
ram_samsung_5 <- nrow(ram_samsung[ram_samsung$심사진행상태 == "원결정유지",])
ram_samsung <- nrow(ram_samsung)

#samsung사 ram 관련 특허건 개수
ram_samsung 
ram_samsung_1 
ram_samsung_2
ram_samsung_3
ram_samsung_4
ram_samsung_5

#samsung사 ram 관련 특허건 비율
ram_samsung_1_per <- ram_samsung_1 / ram_samsung 
ram_samsung_2_per <- ram_samsung_2 / ram_samsung
ram_samsung_3_per <- ram_samsung_3 / ram_samsung
ram_samsung_4_per <- ram_samsung_4 / ram_samsung
ram_samsung_5_per <- ram_samsung_5 / ram_samsung #원결정유지건은 제외
ram_samsung_1_per 
ram_samsung_2_per 
ram_samsung_3_per 
ram_samsung_4_per 


#samsung사 ram 관련 특허건 비율
ram_samsung <- data.frame("심사진행상태"=c("등록결정","거절결정","포기","취하"),
                          "비율"=c(ram_samsung_1_per,ram_samsung_2_per,ram_samsung_3_per,ram_samsung_4_per))
```


```{r, include = FALSE}
##sam tran
#데이터 불러오기 및 전처리
transistor_samsung <- read.csv("C:/Users/dnjs1/Downloads/Rr/transistor_samsung.csv", header=T)
transistor_samsung <- transistor_samsung[!(transistor_samsung$심사진행상태 == ""), ]
transistor_samsung$심사진행상태 <- gsub("\\(.*?\\)","",transistor_samsung$심사진행상태)
#등록결정/거절결정/포기/취하(심사미청구)/기타=원결정유지

transistor_samsung$심사진행상태 <- substr(transistor_samsung$심사진행상태, 1, 5)
transistor_samsung$심사진행상태 <- str_trim(transistor_samsung$심사진행상태)

#각 항목별 개수 파악 (등록결정=1, 거절결정=2, 포기=3, 취하=4, 기타=5(원결정유지) )
transistor_samsung_1 <- nrow(transistor_samsung[transistor_samsung$심사진행상태 == "등록결정",])
transistor_samsung_1 <- nrow(transistor_samsung[transistor_samsung$심사진행상태 == "등록결정",])
transistor_samsung_2 <- nrow(transistor_samsung[transistor_samsung$심사진행상태 == "거절결정",])
transistor_samsung_3 <- nrow(transistor_samsung[transistor_samsung$심사진행상태 == "포기",])
transistor_samsung_4 <- nrow(transistor_samsung[transistor_samsung$심사진행상태 == "취하",])
transistor_samsung_5 <- nrow(transistor_samsung[transistor_samsung$심사진행상태 == "원결정유지",])
transistor_samsung <- nrow(transistor_samsung)

#samsung사 transistor 관련 특허건 개수
transistor_samsung 
transistor_samsung_1 
transistor_samsung_2
transistor_samsung_3
transistor_samsung_4
transistor_samsung_5

#samsung사 transistor 관련 특허건 비율
transistor_samsung_1_per <- transistor_samsung_1 / transistor_samsung 
transistor_samsung_2_per <- transistor_samsung_2 / transistor_samsung
transistor_samsung_3_per <- transistor_samsung_3 / transistor_samsung
transistor_samsung_4_per <- transistor_samsung_4 / transistor_samsung
transistor_samsung_5_per <- transistor_samsung_5 / transistor_samsung #원결정유지건은 제외
transistor_samsung_1_per 
transistor_samsung_2_per 
transistor_samsung_3_per 
transistor_samsung_4_per 

#samsung사 transistor 관련 특허건 비율 그래프
transistor_samsung <- data.frame("심사진행상태"=c("등록결정","거절결정","포기","취하"),
                                 "비율"=c(transistor_samsung_1_per,transistor_samsung_2_per,transistor_samsung_3_per,transistor_samsung_4_per))

```


```{r, include = FALSE}
d_s = ggplot(display_samsung, aes(x=심사진행상태, y=비율, fill=심사진행상태))+
       geom_bar(mapping=aes(fill=심사진행상태),stat = "identity")+
       geom_label(aes(label=round(비율,3),nudge_y = 1.1)) +
       labs(title = "Samsung사 display 관련 특허건 비율")

l_s = ggplot(led_samsung, aes(x=심사진행상태, y=비율, fill=심사진행상태))+
       geom_bar(mapping=aes(fill=심사진행상태),stat = "identity")+
       geom_label(aes(label=round(비율,3),nudge_y = 1.1)) +
       labs(title = "Samsung사 led 관련 특허건 비율")

r_s = ggplot(ram_samsung, aes(x=심사진행상태, y=비율, fill=심사진행상태))+
       geom_bar(mapping=aes(fill=심사진행상태),stat = "identity")+
       geom_label(aes(label=round(비율,3),nudge_y = 1.1)) +
       labs(title = "Samsung사 ram 관련 특허건 비율")

t_s = ggplot(transistor_samsung, aes(x=심사진행상태, y=비율, fill=심사진행상태))+
       geom_bar(mapping=aes(fill=심사진행상태),stat = "identity")+
       geom_label(aes(label=round(비율,3),nudge_y = 1.1)) +
       labs(title = "Samsung사 transistor 관련 특허건 비율")

```

```{r, echo=F}
grid.arrange(d_s,l_s,r_s,t_s)
```


<br>

---

<br>

## 3. SK {-}


```{r, include = FALSE}
##sk dis
#데이터 불러오기 및 전처리
display_sk <- read.csv("C:/Users/dnjs1/Downloads/Rr/skdisplay.csv", header=T, fileEncoding="euc-kr")
display_sk <- display_sk[!(display_sk$심사진행상태 == ""), ]
display_sk$심사진행상태 <- gsub("\\(.*?\\)","",display_sk$심사진행상태)
#등록결정/거절결정/포기/취하(심사미청구)/기타=원결정유지

display_sk$심사진행상태 <- substr(display_sk$심사진행상태, 1, 5)
display_sk$심사진행상태 <- str_trim(display_sk$심사진행상태)

#각 항목별 개수 파악 (등록결정=1, 거절결정=2, 포기=3, 취하=4, 기타=5(원결정유지) )
display_sk_1 <- nrow(display_sk[display_sk$심사진행상태 == "등록결정",])
display_sk_1 <- nrow(display_sk[display_sk$심사진행상태 == "등록결정",])
display_sk_2 <- nrow(display_sk[display_sk$심사진행상태 == "거절결정",])
display_sk_3 <- nrow(display_sk[display_sk$심사진행상태 == "포기",])
display_sk_4 <- nrow(display_sk[display_sk$심사진행상태 == "취하",])
display_sk_5 <- nrow(display_sk[display_sk$심사진행상태 == "원결정유지",])
display_sk <- nrow(display_sk)

#sk사 display 관련 특허건 개수
display_sk #314 #sk사 display 관련 특허 건 수
display_sk_1 #221 #sk사 display 관련 특허 중 등록결정 건 개수 (재심사 후 등록결정건 포함)
display_sk_2 #42 #sk사 display 관련 특허 중 거절결정 건 개수(거절결정 후 재심사중인 건 포함)
display_sk_3 #6 #sk사 display 관련 특허 중 포기(미납) 건 개수
display_sk_4 #43 #sk사 display 관련 특허 중 취하(심사미청구) 건 개수
display_sk_5 #0 #sk사 display 관련 특허 중 원결정유지 건 개수

#sk사 display 관련 특허건 비율
display_sk_1_per <- display_sk_1 / display_sk 
display_sk_2_per <- display_sk_2 / display_sk
display_sk_3_per <- display_sk_3 / display_sk 
display_sk_4_per <- display_sk_4 / display_sk 
display_sk_5_per <- display_sk_5 / display_sk #원결정유지건은 제외
display_sk_1_per #0.7038217
display_sk_2_per #0.133758
display_sk_3_per #0.01910828
display_sk_4_per #0.1369427


#sk사 display 관련 특허건 비율
display_sk <- data.frame("심사진행상태"=c("등록결정","거절결정","포기","취하"),
                         "비율"=c(display_sk_1_per,display_sk_2_per,display_sk_3_per,display_sk_4_per))
```


```{r, include = FALSE}
##sk led
#데이터 불러오기 및 전처리
led_sk <- read.csv("C:/Users/dnjs1/Downloads/Rr/skled.csv", header=T, fileEncoding="euc-kr")
led_sk <- led_sk[!(led_sk$심사진행상태 == ""), ]
led_sk$심사진행상태 <- gsub("\\(.*?\\)","",led_sk$심사진행상태)
#등록결정/거절결정/포기/취하(심사미청구)/기타=원결정유지

led_sk$심사진행상태 <- substr(led_sk$심사진행상태, 1, 5)
led_sk$심사진행상태 <- str_trim(led_sk$심사진행상태)

#각 항목별 개수 파악 (등록결정=1, 거절결정=2, 포기=3, 취하=4, 기타=5(원결정유지) )
led_sk_1 <- nrow(led_sk[led_sk$심사진행상태 == "등록결정",])
led_sk_1 <- nrow(led_sk[led_sk$심사진행상태 == "등록결정",])
led_sk_2 <- nrow(led_sk[led_sk$심사진행상태 == "거절결정",])
led_sk_3 <- nrow(led_sk[led_sk$심사진행상태 == "포기",])
led_sk_4 <- nrow(led_sk[led_sk$심사진행상태 == "취하",])
led_sk_5 <- nrow(led_sk[led_sk$심사진행상태 == "원결정유지",])
led_sk <- nrow(led_sk)

#sk사 led 관련 특허건 개수
led_sk #153 #sk사 led 관련 특허 건 수
led_sk_1 #98 #sk사 led 관련 특허 중 등록결정 건 개수 (재심사 후 등록결정건 포함)
led_sk_2 #11 #sk사 led 관련 특허 중 거절결정 건 개수(거절결정 후 재심사중인 건 포함)
led_sk_3 #2 #sk사 led 관련 특허 중 포기(미납) 건 개수
led_sk_4 #41 #sk사 led 관련 특허 중 취하(심사미청구) 건 개수
led_sk_5 #1 #sk사 led 관련 특허 중 원결정유지 건 개수

#SK사 led 관련 특허건 비율
led_sk_1_per <- led_sk_1 / led_sk 
led_sk_2_per <- led_sk_2 / led_sk
led_sk_3_per <- led_sk_3 / led_sk 
led_sk_4_per <- led_sk_4 / led_sk 
led_sk_5_per <- led_sk_5 / led_sk #원결정유지건은 제외
led_sk_1_per #0.6405229
led_sk_2_per # 0.07189542
led_sk_3_per #0.0130719
led_sk_4_per # 0.2679739

#SK사 led 관련 특허건 비율
led_sk <- data.frame("심사진행상태"=c("등록결정","거절결정","포기","취하"),
                     "비율"=c(led_sk_1_per,led_sk_2_per,led_sk_3_per,led_sk_4_per))
```


```{r, include = FALSE}
##sk ram
#데이터 불러오기 및 전처리
ram_sk <- read.csv("C:/Users/dnjs1/Downloads/Rr/skram.csv", header=T, fileEncoding = "euc-kr")
ram_sk <- ram_sk[!(ram_sk$심사진행상태 == ""), ]
ram_sk$심사진행상태 <- gsub("\\(.*?\\)","",ram_sk$심사진행상태)
#등록결정/거절결정/포기/취하(심사미청구)/기타=원결정유지

ram_sk$심사진행상태 <- substr(ram_sk$심사진행상태, 1, 5)
ram_sk$심사진행상태 <- str_trim(ram_sk$심사진행상태)

#각 항목별 개수 파악 (등록결정=1, 거절결정=2, 포기=3, 취하=4, 기타=5(원결정유지) )
ram_sk_1 <- nrow(ram_sk[ram_sk$심사진행상태 == "등록결정",])
ram_sk_1 <- nrow(ram_sk[ram_sk$심사진행상태 == "등록결정",])
ram_sk_2 <- nrow(ram_sk[ram_sk$심사진행상태 == "거절결정",])
ram_sk_3 <- nrow(ram_sk[ram_sk$심사진행상태 == "포기",])
ram_sk_4 <- nrow(ram_sk[ram_sk$심사진행상태 == "취하",])
ram_sk_5 <- nrow(ram_sk[ram_sk$심사진행상태 == "원결정유지",])
ram_sk <- nrow(ram_sk)

#sk사 ram 관련 특허건 개수
ram_sk 
ram_sk_1 
ram_sk_2
ram_sk_3
ram_sk_4
ram_sk_5

#sk사 ram 관련 특허건 비율
ram_sk_1_per <- ram_sk_1 / ram_sk 
ram_sk_2_per <- ram_sk_2 / ram_sk
ram_sk_3_per <- ram_sk_3 / ram_sk
ram_sk_4_per <- ram_sk_4 / ram_sk
ram_sk_5_per <- ram_sk_5 / ram_sk #원결정유지건은 제외
ram_sk_1_per 
ram_sk_2_per 
ram_sk_3_per 
ram_sk_4_per 

#sk사 ram 관련 특허건 비율
ram_sk <- data.frame("심사진행상태"=c("등록결정","거절결정","포기","취하"),
                     "비율"=c(ram_sk_1_per,ram_sk_2_per,ram_sk_3_per,ram_sk_4_per))
```


```{r, include = FALSE}
##sk tran
#데이터 불러오기 및 전처리
transistor_sk <- read.csv("C:/Users/dnjs1/Downloads/Rr/sktransistor.csv", header=T, fileEncoding = "euc-kr")
transistor_sk <- transistor_sk[!(transistor_sk$심사진행상태 == ""), ]
transistor_sk$심사진행상태 <- gsub("\\(.*?\\)","",transistor_sk$심사진행상태)
#등록결정/거절결정/포기/취하(심사미청구)/기타=원결정유지

transistor_sk$심사진행상태 <- substr(transistor_sk$심사진행상태, 1, 5)
transistor_sk$심사진행상태 <- str_trim(transistor_sk$심사진행상태)

#각 항목별 개수 파악 (등록결정=1, 거절결정=2, 포기=3, 취하=4, 기타=5(원결정유지) )
transistor_sk_1 <- nrow(transistor_sk[transistor_sk$심사진행상태 == "등록결정",])
transistor_sk_1 <- nrow(transistor_sk[transistor_sk$심사진행상태 == "등록결정",])
transistor_sk_2 <- nrow(transistor_sk[transistor_sk$심사진행상태 == "거절결정",])
transistor_sk_3 <- nrow(transistor_sk[transistor_sk$심사진행상태 == "포기",])
transistor_sk_4 <- nrow(transistor_sk[transistor_sk$심사진행상태 == "취하",])
transistor_sk_5 <- nrow(transistor_sk[transistor_sk$심사진행상태 == "원결정유지",])
transistor_sk <- nrow(transistor_sk)

#sk사 transistor 관련 특허건 개수
transistor_sk 
transistor_sk_1 
transistor_sk_2
transistor_sk_3
transistor_sk_4
transistor_sk_5

#sk사 transistor 관련 특허건 비율
transistor_sk_1_per <- transistor_sk_1 / transistor_sk 
transistor_sk_2_per <- transistor_sk_2 / transistor_sk
transistor_sk_3_per <- transistor_sk_3 / transistor_sk
transistor_sk_4_per <- transistor_sk_4 / transistor_sk
transistor_sk_5_per <- transistor_sk_5 / transistor_sk #원결정유지건은 제외
transistor_sk_1_per 
transistor_sk_2_per 
transistor_sk_3_per 
transistor_sk_4_per 


#sk사 transistor 관련 특허건 비율
transistor_sk <- data.frame("심사진행상태"=c("등록결정","거절결정","포기","취하"),
                            "비율"=c(transistor_sk_1_per,transistor_sk_2_per,transistor_sk_3_per,transistor_sk_4_per))
```


```{r, include = FALSE}
d_sk = ggplot(display_sk, aes(x=심사진행상태, y=비율, fill=심사진행상태))+
       geom_bar(mapping=aes(fill=심사진행상태),stat = "identity")+
       geom_label(aes(label=round(비율,3),nudge_y = 1.1)) +
       labs(title = "Sk사 display 관련 특허건 비율")

l_sk = ggplot(led_sk, aes(x=심사진행상태, y=비율, fill=심사진행상태))+
       geom_bar(mapping=aes(fill=심사진행상태),stat = "identity")+
       geom_label(aes(label=round(비율,3),nudge_y = 1.1)) +
       labs(title = "Sk사 led 관련 특허건 비율")

r_sk = ggplot(ram_sk, aes(x=심사진행상태, y=비율, fill=심사진행상태))+
        geom_bar(mapping=aes(fill=심사진행상태),stat = "identity")+
        geom_label(aes(label=round(비율,3),nudge_y = 1.1)) +
        labs(title = "Sk사 ram 관련 특허건 비율")

t_sk = ggplot(transistor_sk, aes(x=심사진행상태, y=비율, fill=심사진행상태))+
        geom_bar(mapping=aes(fill=심사진행상태),stat = "identity")+
        geom_label(aes(label=round(비율,3),nudge_y = 1.1)) +
        labs(title = "Sk사 transistor 관련 특허건 비율")

```

```{r, echo=F}
grid.arrange(d_sk,l_sk,r_sk,t_sk)
```

<br>

---

<br>

## 4. 특허 심사진행 상태 비율  {-}

<br>

```{r, echo=F}
grid.arrange(d_l,d_s,d_sk,
             l_l,l_s,l_sk,
             r_l,r_s,r_sk,
             t_l, t_s,t_sk,
             nrow=4, ncol=3)
```

<br>

---

<br>

---

<br>

# <5> 각 부품별 기업의 특허 개수 비율 {-}

<br>

## 1. 코드 {-}

```{r, include = FALSE}
##Display
#데이터 불러오기 및 전처리
display_lg <- read.csv("C:/Users/dnjs1/Downloads/Rr/display(LG).csv", header=T)
display_lg <- nrow(display_lg)
display_samsung <- read.csv("C:/Users/dnjs1/Downloads/Rr/display_samsung.csv", header=T)
display_samsung <- nrow(display_samsung)
display_sk <- read.csv("C:/Users/dnjs1/Downloads/Rr/skdisplay.csv", header=T, fileEncoding="euc-kr")
display_sk <- nrow(display_sk)
display_all <- sum(display_lg,display_samsung,display_sk)
#비율
display_lg <- display_lg/display_all
display_samsung <- display_samsung/display_all
display_sk <- display_sk/display_all

display <- data.frame("기업"=c("LG","SAMSUNG","SK"),
                      "퍼센트"=c(display_lg*100,display_samsung*100,display_sk*100))
```


```{r, include = FALSE}
##led
#데이터 불러오기 및 전처리
led_lg <- read.csv("C:/Users/dnjs1/Downloads/Rr/LED(LG).csv", header=T)
led_lg <- nrow(led_lg)
led_samsung <- read.csv("C:/Users/dnjs1/Downloads/Rr/led_samsung.csv", header=T)
led_samsung <- nrow(led_samsung)
led_sk <- read.csv("C:/Users/dnjs1/Downloads/Rr/skled.csv", header=T, fileEncoding="euc-kr")
led_sk <- nrow(led_sk)
led_all <- sum(led_lg,led_samsung,led_sk)
#비율
led_lg <- led_lg/led_all
led_samsung <- led_samsung/led_all
led_sk <- led_sk/led_all

led <- data.frame("기업"=c("LG","SAMSUNG","SK"),
                  "퍼센트"=c(led_lg*100,led_samsung*100,led_sk*100))
```


```{r, include = FALSE}
##ram
#데이터 불러오기 및 전처리
ram_lg <- read.csv("C:/Users/dnjs1/Downloads/Rr/RAM(LG).csv", header=T)
ram_lg <- nrow(ram_lg)
ram_samsung <- read.csv("C:/Users/dnjs1/Downloads/Rr/ram_samsung.csv", header=T)
ram_samsung <- nrow(ram_samsung)
ram_sk <- read.csv("C:/Users/dnjs1/Downloads/Rr/skram.csv", header=T, fileEncoding="euc-kr")
ram_sk <- nrow(ram_sk)
ram_all <- sum(ram_lg,ram_samsung,ram_sk)
#비율
ram_lg <- ram_lg/ram_all
ram_samsung <- ram_samsung/ram_all
ram_sk <- ram_sk/ram_all

ram <- data.frame("기업"=c("LG","SAMSUNG","SK"),
                  "퍼센트"=c(ram_lg*100,ram_samsung*100,ram_sk*100))
```


```{r, include = FALSE}
##transistor
#데이터 불러오기 및 전처리
transistor_lg <- read.csv("C:/Users/dnjs1/Downloads/Rr/Transistor(LG).csv", header=T)
transistor_lg <- nrow(transistor_lg)
transistor_samsung <- read.csv("C:/Users/dnjs1/Downloads/Rr/transistor_samsung.csv", header=T)
transistor_samsung <- nrow(transistor_samsung)
transistor_sk <- read.csv("C:/Users/dnjs1/Downloads/Rr/sktransistor.csv", header=T, fileEncoding="euc-kr")
transistor_sk <- nrow(transistor_sk)
transistor_all <- sum(transistor_lg,transistor_samsung,transistor_sk)
#비율
transistor_lg <- transistor_lg/transistor_all
transistor_samsung <- transistor_samsung/transistor_all
transistor_sk <- transistor_sk/transistor_all

transistor <- data.frame("기업"=c("LG","SAMSUNG","SK"),
                         "퍼센트"=c(transistor_lg*100,transistor_samsung*100,transistor_sk*100))
```


```{r, include = FALSE}
##그래프
dis = ggplot(display, aes(x = '', y = 퍼센트, fill = 기업)) +
       geom_bar(width=0.5, stat = "identity", color="white") +
       coord_polar("y",start=1)+
       geom_text(aes(label = paste0(round(퍼센트,2),"%")),
                 position = position_stack(vjust = 0.5))+
       theme_void()+
       labs(title = "Display 관련 특허 내 각 기업 비율")

led = ggplot(led, aes(x = '', y = 퍼센트, fill = 기업)) +
       geom_bar(width=0.5, stat = "identity", color="white") +
       coord_polar("y",start=1)+
       geom_text(aes(label = paste0(round(퍼센트,2),"%")),
                     position = position_stack(vjust = 0.5))+
       theme_void()+
       labs(title = "led 관련 특허 내 각 기업 비율")

ram = ggplot(ram, aes(x = '', y = 퍼센트, fill = 기업)) +
       geom_bar(width=0.5, stat = "identity", color="white") +
        coord_polar("y",start=1)+
       geom_text(aes(label = paste0(round(퍼센트,2),"%")),
                     position = position_stack(vjust = 0.5))+
       theme_void()+
       labs(title = "ram 관련 특허 내 각 기업 비율")

tran = ggplot(transistor, aes(x = '', y = 퍼센트, fill = 기업)) +
        geom_bar(width=0.5, stat = "identity", color="white") +
        coord_polar("y",start=1)+
        geom_text(aes(label = paste0(round(퍼센트,2),"%")),
                      position = position_stack(vjust = 0.5))+
        theme_void()+
        labs(title = "tansistor 관련 특허 내 각 기업 비율")
```
<br>

---

<br>

## 2. 각 부품별 비율  {-}


<div class="warning" style='padding:0.1em; background-color:#F0F8FF; color:#000000'>
<span>
<p style='margin-top:1em; text-align:center'>
<b></b></p>
<p style='margin-left:1em;'>

- Display : SAMSUNG > LG > SK

- RAM : SAMSUNG > SK > LG

- LED : SAMSUNG > LG > SK

- Transistor : SAMSUNG > LG > SK

</p></span>
</div>

<br>

```{r, echo=F}
grid.arrange(dis, ram, led, tran, nrow=2, ncol=2)


```




---

ⓒ Statistical Methods, Gachon University

--------------------------------------------------------------------------------------------------
